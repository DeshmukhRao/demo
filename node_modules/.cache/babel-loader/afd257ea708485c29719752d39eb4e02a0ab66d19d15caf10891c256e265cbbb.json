{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.decryptFile = exports.encryptFile = void 0;\nconst importKeyFromBytes = async keyBytes => window.crypto.subtle.importKey('raw', keyBytes, 'PBKDF2', false, ['deriveKey']);\nconst deriveKey = async (sourceKey, keyUsage, keyDerivationParams) => window.crypto.subtle.deriveKey(keyDerivationParams, sourceKey, {\n  name: 'AES-GCM',\n  length: 256\n}, false, keyUsage);\nconst encryptFile = async (fileArrayBuffer, password) => {\n  try {\n    const plainTextBytes = new Uint8Array(fileArrayBuffer);\n    const passwordBytes = new TextEncoder().encode(password);\n    const salt = window.crypto.getRandomValues(new Uint8Array(16));\n    const iv = window.crypto.getRandomValues(new Uint8Array(12));\n    const passwordKey = await importKeyFromBytes(passwordBytes);\n    const aesKey = await deriveKey(passwordKey, ['encrypt'], {\n      name: 'PBKDF2',\n      salt: salt,\n      iterations: 250000,\n      hash: 'SHA-256'\n    });\n    const cipherBytes = await window.crypto.subtle.encrypt({\n      name: 'AES-GCM',\n      iv: iv\n    }, aesKey, plainTextBytes);\n    const cipherBytesArray = new Uint8Array(cipherBytes);\n    const resultBytes = new Uint8Array(cipherBytesArray.byteLength + salt.byteLength + iv.byteLength);\n    resultBytes.set(salt, 0);\n    resultBytes.set(iv, salt.byteLength);\n    resultBytes.set(cipherBytesArray, salt.byteLength + iv.byteLength);\n    return resultBytes;\n  } catch (error) {\n    console.error('Error encrypting file');\n    console.error(error);\n    throw error;\n  }\n};\nexports.encryptFile = encryptFile;\nconst decryptFile = async (cipher, password) => {\n  try {\n    const cipherBytes = new Uint8Array(cipher);\n    const passwordBytes = new TextEncoder().encode(password);\n    const salt = cipherBytes.slice(0, 16);\n    const iv = cipherBytes.slice(16, 16 + 12);\n    const data = cipherBytes.slice(16 + 12);\n    const passwordKey = await importKeyFromBytes(passwordBytes);\n    const aesKey = await deriveKey(passwordKey, ['decrypt'], {\n      name: 'PBKDF2',\n      salt: salt,\n      iterations: 250000,\n      hash: 'SHA-256'\n    });\n    const decryptedContent = await window.crypto.subtle.decrypt({\n      name: 'AES-GCM',\n      iv: iv\n    }, aesKey, data);\n    return decryptedContent;\n  } catch (error) {\n    console.error('Error decrypting file');\n    console.error(error);\n    return;\n  }\n};\nexports.decryptFile = decryptFile;","map":{"version":3,"names":["Object","defineProperty","exports","value","decryptFile","encryptFile","importKeyFromBytes","keyBytes","window","crypto","subtle","importKey","deriveKey","sourceKey","keyUsage","keyDerivationParams","name","length","fileArrayBuffer","password","plainTextBytes","Uint8Array","passwordBytes","TextEncoder","encode","salt","getRandomValues","iv","passwordKey","aesKey","iterations","hash","cipherBytes","encrypt","cipherBytesArray","resultBytes","byteLength","set","error","console","cipher","slice","data","decryptedContent","decrypt"],"sources":["D:/demo/node_modules/@lighthouse-web3/sdk/dist/Lighthouse/uploadEncrypted/encryptionBrowser.js"],"sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.decryptFile = exports.encryptFile = void 0;\nconst importKeyFromBytes = async (keyBytes) => window.crypto.subtle.importKey('raw', keyBytes, 'PBKDF2', false, [\n    'deriveKey',\n]);\nconst deriveKey = async (sourceKey, keyUsage, keyDerivationParams) => window.crypto.subtle.deriveKey(keyDerivationParams, sourceKey, { name: 'AES-GCM', length: 256 }, false, keyUsage);\nconst encryptFile = async (fileArrayBuffer, password) => {\n    try {\n        const plainTextBytes = new Uint8Array(fileArrayBuffer);\n        const passwordBytes = new TextEncoder().encode(password);\n        const salt = window.crypto.getRandomValues(new Uint8Array(16));\n        const iv = window.crypto.getRandomValues(new Uint8Array(12));\n        const passwordKey = await importKeyFromBytes(passwordBytes);\n        const aesKey = await deriveKey(passwordKey, ['encrypt'], {\n            name: 'PBKDF2',\n            salt: salt,\n            iterations: 250000,\n            hash: 'SHA-256',\n        });\n        const cipherBytes = await window.crypto.subtle.encrypt({ name: 'AES-GCM', iv: iv }, aesKey, plainTextBytes);\n        const cipherBytesArray = new Uint8Array(cipherBytes);\n        const resultBytes = new Uint8Array(cipherBytesArray.byteLength + salt.byteLength + iv.byteLength);\n        resultBytes.set(salt, 0);\n        resultBytes.set(iv, salt.byteLength);\n        resultBytes.set(cipherBytesArray, salt.byteLength + iv.byteLength);\n        return resultBytes;\n    }\n    catch (error) {\n        console.error('Error encrypting file');\n        console.error(error);\n        throw error;\n    }\n};\nexports.encryptFile = encryptFile;\nconst decryptFile = async (cipher, password) => {\n    try {\n        const cipherBytes = new Uint8Array(cipher);\n        const passwordBytes = new TextEncoder().encode(password);\n        const salt = cipherBytes.slice(0, 16);\n        const iv = cipherBytes.slice(16, 16 + 12);\n        const data = cipherBytes.slice(16 + 12);\n        const passwordKey = await importKeyFromBytes(passwordBytes);\n        const aesKey = await deriveKey(passwordKey, ['decrypt'], {\n            name: 'PBKDF2',\n            salt: salt,\n            iterations: 250000,\n            hash: 'SHA-256',\n        });\n        const decryptedContent = await window.crypto.subtle.decrypt({\n            name: 'AES-GCM',\n            iv: iv,\n        }, aesKey, data);\n        return decryptedContent;\n    }\n    catch (error) {\n        console.error('Error decrypting file');\n        console.error(error);\n        return;\n    }\n};\nexports.decryptFile = decryptFile;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}